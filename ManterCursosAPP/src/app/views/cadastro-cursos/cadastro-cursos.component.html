<h1 class="text-center">Listagem de Cursos</h1>
<!--Botão voltar Home-->
<button type="button" class="btn btn-dark" data-bs-toggle="modal" data-bs-target="home" routerLink="/home"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-left-circle" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8zm15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-4.5-.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H11.5z"/></svg> Voltar</button>
<!--Botão cadastrar Curso-->
<button type="button" class="btn btn-primary float-end " data-bs-toggle="modal" data-bs-target="#exampleModal"  ><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-plus-circle" viewBox="0 0 16 16"><path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/><path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/></svg>  Adicionar Curso</button>

<!-- Busca por Data -->
<div class="row">
  <div class="col-md-0">
  </div><br>
  <div class="col-md-6" style="width: 200 px;">
    <b><label for=""> Buscar por Data</label></b> <p>
      <input type="date" [(ngModel)]="date">
  </div>
  <p></p>
  <!-- Busca por Nome -->
  <div class="col-md-2" style="display: flex; flex-direction: column; width: 700px;">
   <b>   <label for="">Busca por Nome</label></b>
    <input type="text" placeholder="Buscar" [(ngModel)]="curso.buscar">
  </div>
  <div class="col-md"></div>
</div>
<!-- Modal p/ chamar o cadastrar curso & Editar -->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content" style="width: 800px; margin-left: -100px;">
      <div class="modal-header">
       <b> <h2 class="modal-title" id="exampleModalLabel">Curso</h2></b>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <!-- Inicio Forms de cadastro/editar de curso -->
        <form  class="needs-validation" novalidate autocomplete="off" class="row g-3 form-curso" #form="ngForm">
          <!--Associação das tabelas de cadastro e log-->
          <input type="hidden" name="cursoID" [value]="curso.formData.cursoID"/>
          <input type="hidden" name="logID" [value]="curso.formDataLog.logID" />
          <!--Tabela-->
          <div class="col-md-4">
            <b><label for="validationDefault01" class="form-label">Descrição do Assunto*</label></b>
            <input type="text" name="descricaoCurso" class="form-control" id="validationDefault01 "ng-model="descricaoCurso.value" [class.invalid]="descricaoCurso.invalid && descricaoCurso.touched"  #descricaoCurso="ngModel" [(ngModel)]="curso.formData.descricaoCurso" required min="">
          </div>
          <div class="col-md-4">
           <b> <label for="validationDefault02" class="form-label">Data de Inicio*</label></b>
            <input type="date" name="dataInicio" min="{{dataAtual | date: 'yyyy-MM-dd'}}" class="form-control" id="validationDefault02" [class.invalid]="dataInicio.invalid && dataInicio.touched"  #dataInicio="ngModel" [(ngModel)]="curso.formData.dataInicio" required>
          </div>
          <div class="col-md-4">
           <b> <label for="validationDefaultUsername" class="form-label">Data de Término*</label></b>
            <input type="date" name="datatermino" class="form-control" id="validationDefault02" [(ngModel)]="curso.formData.datatermino" [class.invalid]="datatermino.invalid && datatermino.touched"  #datatermino="ngModel" required min="{{curso.formData.dataInicio | date: 'yyyy-MM-dd'}}">
          </div>
          <div class="col-md-4">
            <b><label for="" class="form-label">Nº de Alunos</label></b>
            <input type="text" onkeypress="return event.charCode >= 48 && event.charCode <= 57" name="quantidadeAlunos" class="form-control" [(ngModel)]="curso.formData.quantidadeAlunos" min="0">
          </div>
          <div class="col-md-3">
           <b> <label for="validationDefault04" class="form-label">Categoria*</label></b>
            <select class="form-select" name="categoriaID"  id="validationDefault04" [class.invalid]="categoriaID.invalid && categoriaID.touched"  #categoriaID="ngModel"  [(ngModel)]="curso.formData.categoriaID" required>
              <option *ngFor="let cate of categoria.list" value= {{cate.categoriaID}}>
                {{cate.nome}}</option>
            </select>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-left-square" viewBox="0 0 16 16">
              <path fill-rule="evenodd" d="M15 2a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2zM0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2zm11.5 5.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H11.5z"/>
            </svg> Voltar</button>
            <button type="submit" class="btn btn-success" (click)="validacaoFormulario(form, curso.formData.dataInicio, curso.formData.datatermino, curso.formData.descricaoCurso, curso.formData.categoriaID, curso.formData.quantidadeAlunos)"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-save" viewBox="0 0 16 16">
              <path d="M2 1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H9.5a1 1 0 0 0-1 1v7.293l2.646-2.647a.5.5 0 0 1 .708.708l-3.5 3.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L7.5 9.293V2a2 2 0 0 1 2-2H14a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h2.5a.5.5 0 0 1 0 1H2z"/>
            </svg> Adicionar</button>
          </div>
        </form>
        <!-- Fim do Forms de cadastro/editar de curso -->
      </div>
    </div>
  </div>
</div>
<!-- Inicio da tabela de cursos-->
<table class="table table-striped">
  <thead class="thead-dark">
    <tr>
      <th>Descrição</th>
      <th>Data Inicio</th>
      <th>Data Termino</th>
      <th>Quantidade Alunos</th>
      <th>Categoria</th>
      <th></th>
    </tr>
  </thead>
    <tbody>
        <tr *ngFor="let cursos of curso.list | filter: curso.buscar | filter: date; let i = index">
          <td (click)="populateForm(cursos)">{{cursos.descricaoCurso}}</td>
          <td (click)="populateForm(cursos)">{{cursos.dataInicio | date: 'dd/MM/yyyy'}}</td>
          <td (click)="populateForm(cursos)">{{cursos.datatermino | date: 'dd/MM/yyyy'}}</td>
          <td (click)="populateForm(cursos)">{{cursos.quantidadeAlunos}}</td>
          <td (click)="populateForm(cursos)">{{getCategoria(cursos.categoriaID).nome}}</td>
          <td class="buttons">
            <button  class="btn btn-warning" data-bs-toggle="modal"  data-bs-target="#exampleModal" (click)="populateForm(cursos)"><i class="fas fa-edit"></i> Editar</button>
            <button data-bs-toggle="modal" data-bs-target="#modalExclusao" class="btn btn-danger" *ngIf="dataCerta < cursos.datatermino.toString()" (click)="ValidarExclusao(cursos.cursoID)"><i class="fas fa-trash-alt"></i> Deletar</button>
          </td>
    </tbody>
</table>
<!-- Modal Confirmar Exclusão Curso-->
<div class="modal fade" tabindex="-1" id="modalExclusao">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <b><h2 class="modal-title">Exclusão</h2></b>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
        <p>Tem certeza que deseja realizar a exclusão do curso?</p>
      </div>
      <div class="modal-footer">
        <button
          type="button"
          class="btn btn-secondary"
          data-bs-dismiss="modal"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-left-square" viewBox="0 0 16 16">
            <path fill-rule="evenodd" d="M15 2a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2zM0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2zm11.5 5.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H11.5z"/>
          </svg>
          Não
        </button>
        <button
          type="button"
          class="btn btn-danger"
          (click)="Delete(excluir)"
          data-bs-dismiss="modal"
        ><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-save" viewBox="0 0 16 16">
          <path d="M2 1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H9.5a1 1 0 0 0-1 1v7.293l2.646-2.647a.5.5 0 0 1 .708.708l-3.5 3.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L7.5 9.293V2a2 2 0 0 1 2-2H14a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h2.5a.5.5 0 0 1 0 1H2z"/>
        </svg>
          Excluir
        </button>
      </div>
    </div>
  </div>
</div>
